# 台股資料抓取工具 - 使用說明

## 📦 檔案說明

這個工具包含兩個版本：


### 版本 2：前後端分離版本（推薦）✅
- **後端**：stock_api.py（Python Flask 伺服器）
- **前端**：taiwan-stock-scraper-v2.html
- **優點**：更穩定、速度更快、沒有 CORS 限制

---

## 🚀 快速開始（版本 2 - 推薦）

### 步驟 1：安裝 Python 套件

```bash
pip install flask flask-cors requests
```

### 步驟 2：啟動後端伺服器

```bash
python stock_api.py
```

你應該會看到：
```
🚀 台股資料抓取 API 伺服器啟動中...
📍 伺服器位址: http://localhost:5000
💡 請在瀏覽器開啟 taiwan-stock-scraper-v2.html
```

### 步驟 3：開啟前端網頁

在瀏覽器中開啟 `taiwan-stock-scraper-v2.html`

---

## 📊 功能說明

### 資料類型

1. **每日股價資料**
   - 開盤價
   - 收盤價
   - 最高價
   - 最低價
   - 成交股數
   - 成交金額
   - 成交筆數
   - 漲跌價差

2. **三大法人買賣超**
   - 外資及陸資：買進、賣出、買賣超
   - 投信：買進、賣出、買賣超
   - 自營商：買進、賣出、買賣超
   - 三大法人買賣超合計

### 使用步驟

1. **輸入股票代碼**
   - 例如：2330（台積電）
   - 例如：2454（聯發科）

2. **選擇日期區間**
   - 建議：不超過 3 個月（速度較快）
   - 最大：可抓取一年資料（需要較長時間）

3. **勾選資料類型**
   - 可以只選股價資料
   - 可以只選法人資料
   - 或是兩者都選

4. **開始抓取**
   - 點擊「開始抓取資料」按鈕
   - 等待資料抓取完成
   - 可以在網頁上預覽前 100 筆資料

5. **下載 CSV**
   - 點擊「下載 CSV 檔案」
   - 檔案名稱格式：`股票代碼_開始日期_結束日期.csv`
   - 例如：`2330_20240101_20240131.csv`

---

## ⚠️ 注意事項

### 速度考量
- **股價資料**：按月份批次抓取，速度較快
- **法人資料**：需要逐日抓取，速度較慢
- 建議一次不要抓取超過 3 個月的法人資料

### API 限制
- 證交所 API 有請求頻率限制
- 程式已內建延遲機制（1-2秒/次請求）
- 如果抓取失敗，請稍等幾分鐘後再試

### 股票代碼
- 只支援「上市股票」（證交所）
- 櫃買股票（OTC）可能無法抓取
- 確認股票代碼正確（4位數字）

### 日期範圍
- 只能抓取已交易日的資料
- 週末和國定假日沒有資料
- 查詢未來日期會回傳空資料

---

## 🛠️ 故障排除

### 問題 1：無法連接伺服器
**症狀**：網頁顯示「無法連接後端伺服器」

**解決方法**：
1. 確認 Python 伺服器已啟動
2. 檢查終端機是否顯示錯誤訊息
3. 確認伺服器運行在 http://localhost:5000

### 問題 2：抓取資料失敗
**症狀**：顯示「未能獲取資料」

**解決方法**：
1. 確認股票代碼正確（例如：2330）
2. 確認日期區間在合理範圍內
3. 檢查是否為交易日（非週末或假日）
4. 稍等幾分鐘後再試（可能是 API 限流）

### 問題 3：CSV 檔案亂碼
**症狀**：下載的 CSV 檔案在 Excel 中顯示亂碼

**解決方法**：
1. 使用 Excel 的「資料」→「從文字檔」匯入
2. 選擇 UTF-8 編碼
3. 或是使用 Google Sheets 開啟（自動處理編碼）

---

## 📝 範例

### 範例 1：抓取台積電一個月股價
- 股票代碼：2330
- 開始日期：2024-01-01
- 結束日期：2024-01-31
- 資料類型：☑ 每日股價資料

### 範例 2：抓取聯發科三大法人資料
- 股票代碼：2454
- 開始日期：2024-01-01
- 結束日期：2024-01-31
- 資料類型：☑ 三大法人買賣超

### 範例 3：抓取完整資料
- 股票代碼：2330
- 開始日期：2024-01-01
- 結束日期：2024-01-31
- 資料類型：☑ 每日股價資料 + ☑ 三大法人買賣超

---

## 💡 常用股票代碼

- 2330：台積電
- 2454：聯發科
- 2317：鴻海
- 2412：中華電
- 2308：台達電
- 2882：國泰金
- 2303：聯電
- 6505：台塑化
- 2002：中鋼
- 1301：台塑

---

## 📧 技術支援

如有任何問題，請確認：
1. Python 版本 >= 3.7
2. 所有套件已正確安裝
3. 網路連線正常
4. 伺服器正在運行

---

## 🎉 開始使用

現在你可以開始抓取台股資料了！祝你使用愉快！
